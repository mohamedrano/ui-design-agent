#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

echo "🔍 Validating commit message..."

# Run commitlint to validate commit message format
npx --no -- commitlint --edit "$1"

if [ $? -ne 0 ]; then
  echo ""
  echo "❌ Commit message validation failed!"
  echo ""
  echo "📋 Your commit message should follow the Conventional Commits format:"
  echo "   <type>[optional scope]: <description>"
  echo ""
  echo "🎯 Examples:"
  echo "   feat: add voice UI support"
  echo "   fix(ui): resolve accessibility contrast issues"
  echo "   docs: update API documentation"
  echo "   style: format code with prettier"
  echo "   refactor: improve component structure"
  echo "   test: add unit tests for design analyzer"
  echo "   chore: update dependencies"
  echo ""
  echo "📖 Valid types:"
  echo "   feat     - new features"
  echo "   fix      - bug fixes"
  echo "   docs     - documentation changes"
  echo "   style    - code style changes (formatting, etc)"
  echo "   refactor - code refactoring"
  echo "   test     - adding or updating tests"
  echo "   chore    - maintenance tasks"
  echo "   perf     - performance improvements"
  echo "   ci       - CI/CD changes"
  echo "   build    - build system changes"
  echo "   revert   - reverting previous commits"
  echo ""
  echo "💡 Tips:"
  echo "   - Use present tense (add, not added)"
  echo "   - Keep subject line under 50 characters"
  echo "   - Don't end with a period"
  echo "   - Use Arabic for descriptions if preferred: feat: إضافة دعم الواجهة الصوتية"
  echo ""
  exit 1
fi

echo "✅ Commit message is valid!"
